<!DOCTYPE html>
<html lang="zh-Hans">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="åœ¨æ¨å¯¼EMç®—æ³•ä¹‹å‰å…ˆå­¦ä¹ ä¸€ä¸‹Jensenä¸ç­‰å¼[1]ï¼ŒJensenä¸ç­‰å¼çš„å®šä¹‰å¦‚ä¸‹ï¼šè‹¥$f$æ˜¯å‡¸å‡½æ•°ï¼Œåˆ™
f(t x_1 + (1-t)x_2)\leq tf(x_1)+(1-t)f(x_2)å…¶ä¸­$t\in [0,1]$ã€‚åŒç†ï¼Œè‹¥$f$æ˜¯å‡¹å‡½æ•°ï¼Œåˆ™åªéœ€å°†ä¸Šå¼çš„$\leq$æ¢æˆ$\geq$å³å¯ã€‚
å°†ä¸Š">
    

    <!--Author-->
    
        <meta name="author" content="Sm1les">
    

    <!-- Title -->
    
    <title>EMç®—æ³• | Sm1les&#39;s blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Noto+Serif:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]--><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>

    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- Content -->
    <section class="article-container">
<!-- Back Home -->
<a class="nav-back" href="/">
    <i class="fa fa-puzzle-piece"></i>
</a>

<!-- Page Header -->
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>EMç®—æ³•</h1>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Main Content -->
            <div class="post-content col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>åœ¨æ¨å¯¼EMç®—æ³•ä¹‹å‰å…ˆå­¦ä¹ ä¸€ä¸‹<strong>Jensenä¸ç­‰å¼<sup><a href="#ref1">[1]</a></sup></strong>ï¼ŒJensenä¸ç­‰å¼çš„å®šä¹‰å¦‚ä¸‹ï¼šè‹¥<br>$f$æ˜¯<strong>å‡¸å‡½æ•°</strong>ï¼Œåˆ™</p>
<script type="math/tex; mode=display">f(t x_1 + (1-t)x_2)\leq tf(x_1)+(1-t)f(x_2)</script><p>å…¶ä¸­$t\in [0,1]$ã€‚åŒç†ï¼Œè‹¥$f$æ˜¯<strong>å‡¹å‡½æ•°</strong>ï¼Œåˆ™åªéœ€å°†ä¸Šå¼çš„$\leq$æ¢æˆ$\geq$å³å¯ã€‚</p>
<p>å°†ä¸Šå¼ä¸­çš„$t$æ¨å¹¿åˆ°$n$ä¸ªåŒæ ·æˆç«‹ï¼Œå³</p>
<script type="math/tex; mode=display">f(t_1 x_1 + t_2x_2+...+t_nx_n)\leq t_1f(x_1)+t_2f(x_2)+...+t_nf(t_n)</script><p>å…¶ä¸­$t_1,t_2,â€¦,t_n\in[0,1],t_1+t_2+â€¦+t_n=1$ã€‚</p>
<p>ä¸Šå¼åœ¨æ¦‚ç‡è®ºä¸­é€šå¸¸ä»¥å¦‚ä¸‹å½¢å¼å‡ºç°ï¼š</p>
<script type="math/tex; mode=display">\varphi(E[X])\leq E[\varphi(X)]</script><p>å…¶ä¸­$X$æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œ$\varphi$ä¸ºå‡¸å‡½æ•°ï¼Œ$E[X]$ä¸ºéšæœºå˜é‡$X$çš„æœŸæœ›ã€‚</p>
<h3 id="EMï¼ˆExpectation-Maximizationï¼‰ç®—æ³•çš„å¯¼å‡º-2"><a href="#EMï¼ˆExpectation-Maximizationï¼‰ç®—æ³•çš„å¯¼å‡º-2" class="headerlink" title="EMï¼ˆExpectation Maximizationï¼‰ç®—æ³•çš„å¯¼å‡º[2]"></a>EMï¼ˆExpectation Maximizationï¼‰ç®—æ³•çš„å¯¼å‡º<sup><a href="#ref2">[2]</a></sup></h3><p>æˆ‘ä»¬é¢å¯¹ä¸€ä¸ªå«æœ‰éšå˜é‡çš„æ¦‚ç‡æ¨¡å‹ï¼Œç›®æ ‡æ˜¯æå¤§åŒ–è§‚æµ‹æ•°æ®ï¼ˆä¸å®Œå…¨æ•°æ®ï¼‰$Y$å…³äºå‚æ•°$\theta$çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼Œå³æå¤§åŒ–</p>
<script type="math/tex; mode=display">L(\theta)=\ln P(Y\vert \theta)=\ln \sum_Z P(Y,Z\vert\theta)=\ln \left(\sum_Z P(Y\vert Z,\theta)P(Z\vert \theta)\right)</script><p>æ³¨æ„åˆ°è¿™ä¸€æå¤§åŒ–çš„ä¸»è¦å›°éš¾æ˜¯ä¸Šå¼ä¸­æœ‰æœªè§‚æµ‹æ•°æ®$Z$å¹¶æœ‰åŒ…å«å’Œï¼ˆ$Z$ä¸ºç¦»æ•£å‹æ—¶ï¼‰æˆ–è€…ç§¯åˆ†ï¼ˆ$Z$ä¸ºè¿ç»­å‹æ—¶ï¼‰çš„å¯¹æ•°ã€‚EMç®—æ³•é‡‡ç”¨çš„æ˜¯é€šè¿‡è¿­ä»£é€æ­¥è¿‘ä¼¼æå¤§åŒ–$L(\theta)$ï¼šå‡è®¾åœ¨ç¬¬$i$æ¬¡è¿­ä»£å$\theta$çš„ä¼°è®¡å€¼æ˜¯$\theta^{(i)}$ï¼Œæˆ‘ä»¬å¸Œæœ›æ–°çš„ä¼°è®¡å€¼$\theta$èƒ½ä½¿$L(\theta)$å¢åŠ ï¼Œå³$L(\theta)&gt;L(\theta^{(i)})$ï¼Œå¹¶é€æ­¥è¾¾åˆ°æå¤§å€¼ã€‚ä¸ºæ­¤ï¼Œè€ƒè™‘ä¸¤è€…çš„å·®ï¼š</p>
<script type="math/tex; mode=display">\begin{aligned}
L(\theta)-L(\theta^{(i)})&=\ln \left(\sum_Z P(Y\vert Z,\theta)P(Z\vert \theta)\right)-\ln P(Y\vert\theta^{(i)}) \\
&=\ln \left(\sum_Z P(Z\vert Y,\theta^{(i)}) \cfrac{P(Y\vert Z,\theta)P(Z\vert \theta)}{P(Z\vert Y,\theta^{(i)})}\right)-\ln P(Y\vert\theta^{(i)})
\end{aligned}</script><p>æ³¨æ„ï¼Œä¸Šå¼ä¸­é‡‡ç”¨çš„æ˜¯å’Œå‚è€ƒæ–‡çŒ®<a href="#ref3">[3]</a>ä¸€æ ·ä¸Šä¸‹åŒæ—¶ä¹˜ä»¥$P(Z\vert Y,\theta^{(i)})$ï¼Œè€Œå‚è€ƒæ–‡çŒ®<a href="#ref2">[2]</a>ä¸­ä¸€å¼€å§‹ä¸Šä¸‹åŒä¹˜çš„æ˜¯$P(Y\vert Z,\theta^{(i)})$ï¼Œè€Œåç»­å´ç”¨çš„æ˜¯$P(Z\vert Y,\theta^{(i)})$ï¼Œä¸çŸ¥æ˜¯å¦æœ‰åŸç”±è¿˜æ˜¯ä½œè€…ç¬”è¯¯ï¼Œæš‚ä¸çŸ¥æ™“ï¼Œæ¥ç€ç”±ä¸Šè¿°Jensenä¸ç­‰å¼ä»¥åŠ$\ln$å‡½æ•°ä¸º<strong>å‡¹å‡½æ•°</strong>å¯å¾—ï¼š</p>
<script type="math/tex; mode=display">\begin{aligned}
L(\theta)-L(\theta^{(i)})&=\ln \left(\sum_Z P(Z\vert Y,\theta^{(i)}) \cfrac{P(Y\vert Z,\theta)P(Z\vert \theta)}{P(Z\vert Y,\theta^{(i)})}\right)-\ln P(Y\vert\theta^{(i)})  \\
&\geq \sum_Z P(Z\vert Y,\theta^{(i)})\ln \cfrac{P(Y\vert Z,\theta)P(Z\vert \theta)}{P(Z\vert Y,\theta^{(i)})}-\ln P(Y\vert\theta^{(i)}) \\
&= \sum_Z P(Z\vert Y,\theta^{(i)})\ln \cfrac{P(Y\vert Z,\theta)P(Z\vert \theta)}{P(Z\vert Y,\theta^{(i)})}-1\cdot \ln P(Y\vert\theta^{(i)}) \\
&= \sum_Z P(Z\vert Y,\theta^{(i)})\ln \cfrac{P(Y\vert Z,\theta)P(Z\vert \theta)}{P(Z\vert Y,\theta^{(i)})}-\sum_Z P(Z\vert Y,\theta^{(i)})\cdot \ln P(Y\vert\theta^{(i)}) \\
&=\sum_Z P(Z\vert Y,\theta^{(i)}) \left( \ln \cfrac{P(Y\vert Z,\theta)P(Z\vert \theta)}{P(Z\vert Y,\theta^{(i)})} - \ln P(Y\vert\theta^{(i)}) \right)\\
&= \sum_Z P(Z\vert Y,\theta^{(i)})\ln \cfrac{P(Y\vert Z,\theta)P(Z\vert \theta)}{P(Z\vert Y,\theta^{(i)})P(Y\vert\theta^{(i)})}
\end{aligned}</script><p>ä»¤</p>
<script type="math/tex; mode=display">B(\theta,\theta^{(i)})=L(\theta^{(i)})+\sum_Z P(Z\vert Y,\theta^{(i)})\ln \cfrac{P(Y\vert Z,\theta)P(Z\vert \theta)}{P(Z\vert Y,\theta^{(i)})P(Y\vert\theta^{(i)})}</script><p>åˆ™</p>
<script type="math/tex; mode=display">L(\theta)\geq B(\theta,\theta^{(i)})</script><p>å³å‡½æ•°$B(\theta,\theta^{(i)})$æ˜¯$L(\theta)$çš„ä¸€ä¸ªä¸‹ç•Œï¼Œæ­¤æ—¶è‹¥è®¾$\theta^{(i+1)}$ä½¿å¾—$B(\theta,\theta^{(i)})$è¾¾åˆ°æå¤§ï¼Œä¹Ÿå³</p>
<script type="math/tex; mode=display">B(\theta^{(i+1)},\theta^{(i)}) \geq B(\theta^{(i)},\theta^{(i)})</script><p>ç”±äº$L(\theta^{(i)})=B(\theta^{(i)},\theta^{(i)})$ï¼Œæ‰€ä»¥å¯ä»¥è¿›ä¸€æ­¥æ¨å¾—ï¼š</p>
<script type="math/tex; mode=display">L(\theta^{(i+1)})\geq B(\theta^{(i+1)},\theta^{(i)})\geq B(\theta^{(i)},\theta^{(i)})=L(\theta^{(i)})</script><script type="math/tex; mode=display">L(\theta^{(i+1)})\geq L(\theta^{(i)})</script><p><center>
<img src="./em.png" width="60%" height="60%"><br>
æ­¤å›¾æ˜¯å¯¹ä¸Šè¿°ä¸ç­‰å¼çš„ç›´è§‚è§£é‡Š
</center><br>å› æ­¤ï¼Œä»»ä½•å¯ä»¥ä½¿$B(\theta,\theta^{(i)})$å¢å¤§çš„$\theta$ï¼Œä¹Ÿå¯ä»¥ä½¿$L(\theta)$å¢å¤§ï¼Œäºæ˜¯é—®é¢˜å°±è½¬åŒ–ä¸ºäº†æ±‚è§£èƒ½ä½¿å¾—$B(\theta,\theta^{(i)})$è¾¾åˆ°æå¤§çš„$\theta^{(i+1)}$ï¼Œå³</p>
<script type="math/tex; mode=display">\begin{aligned}
\theta^{(i+1)}&=\mathop{\arg\max}_{\theta}B(\theta,\theta^{(i)}) \\
&=\mathop{\arg\max}_{\theta}\left( L(\theta^{(i)})+\sum_Z P(Z\vert Y,\theta^{(i)})\ln \cfrac{P(Y\vert Z,\theta)P(Z\vert \theta)}{P(Z\vert Y,\theta^{(i)})P(Y\vert\theta^{(i)})}\right)
\end{aligned}</script><p>ç•¥å»å¯¹$\theta$çš„æå¤§åŒ–è€Œè¨€æ˜¯å¸¸æ•°çš„é¡¹ï¼š</p>
<script type="math/tex; mode=display">\begin{aligned}
\theta^{(i+1)}&=\mathop{\arg\max}_{\theta}\left(\sum_Z P(Z\vert Y,\theta^{(i)})\ln\left( P(Y\vert Z,\theta)P(Z\vert \theta)\right)\right) \\
&=\mathop{\arg\max}_{\theta}\left(\sum_Z P(Z\vert Y,\theta^{(i)})\ln P(Y,Z\vert \theta)\right) \\
&=\mathop{\arg\max}_{\theta}Q(\theta,\theta^{(i)})
\end{aligned}</script><p>åˆ°æ­¤å³å®Œæˆäº†EMç®—æ³•çš„ä¸€æ¬¡è¿­ä»£ï¼Œæ±‚å‡ºçš„$\theta^{(i+1)}$ä½œä¸ºä¸‹ä¸€æ¬¡è¿­ä»£çš„åˆå§‹$\theta^{(i)}$ã€‚ç»¼ä¸Šå¯ä»¥æ€»ç»“å‡ºEMç®—æ³•çš„â€œEæ­¥â€å’Œâ€œMæ­¥â€åˆ†åˆ«ä¸ºï¼š<br><strong>Eæ­¥ï¼š</strong>è®¡ç®—å®Œå…¨æ•°æ®çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°$\ln P(Y,Z\vert \theta)$å…³äºåœ¨ç»™å®šè§‚æµ‹æ•°æ®$Y$å’Œå½“å‰å‚æ•°$\theta^{(i)}$ä¸‹å¯¹æœªè§‚æµ‹æ•°æ®$Z$çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$ P(Z\vert Y,\theta^{(i)})$çš„æœŸæœ›ï¼Œä¹Ÿå³$Q$å‡½æ•°ï¼š</p>
<script type="math/tex; mode=display">Q(\theta,\theta^{(i)})=E_Z[\ln P(Y,Z\vert \theta)\vert Y,\theta^{(i)}]=\sum_Z P(Z\vert Y,\theta^{(i)})\ln P(Y,Z\vert \theta)</script><p><strong>Mæ­¥ï¼š</strong>æ±‚ä½¿å¾—$Q$å‡½æ•°åˆ°è¾¾æå¤§çš„$\theta^{(i+1)}$ã€‚<br>EMç®—æ³•çš„åŸºæœ¬æ€æƒ³å¯ä»¥æ€»ç»“ä¸º<sup><a href="#ref4">[4]</a></sup>ï¼šè‹¥å‚æ•°$\theta$å·²çŸ¥ï¼Œåˆ™å¯æ ¹æ®è§‚æµ‹æ•°æ®$Y$æ¨æ–­å‡ºæœ€ä¼˜éšå˜é‡$Z$çš„å€¼ï¼ˆEæ­¥ï¼‰ï¼›åä¹‹ï¼Œè‹¥$Z$çš„å€¼å·²çŸ¥ï¼Œåˆ™å¯æ–¹ä¾¿åœ°å¯¹å‚æ•°$\theta$åšæå¤§ä¼¼ç„¶ä¼°è®¡ï¼ˆMæ­¥ï¼‰ã€‚</p>
<h3 id="EMç®—æ³•åœ¨é«˜æ–¯æ··åˆæ¨¡å‹ä¸­çš„åº”ç”¨-2-3-5"><a href="#EMç®—æ³•åœ¨é«˜æ–¯æ··åˆæ¨¡å‹ä¸­çš„åº”ç”¨-2-3-5" class="headerlink" title="EMç®—æ³•åœ¨é«˜æ–¯æ··åˆæ¨¡å‹ä¸­çš„åº”ç”¨[2][3][5]"></a>EMç®—æ³•åœ¨é«˜æ–¯æ··åˆæ¨¡å‹ä¸­çš„åº”ç”¨<sup><a href="#ref2">[2]</a></sup><sup><a href="#ref3">[3]</a></sup><sup><a href="#ref5">[5]</a></sup></h3><p>é«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGaussian Mixture Modelï¼ŒGMMï¼‰å®šä¹‰å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">P(y|\theta)=\sum_{k=1}^{K}\alpha_k\phi(y\vert \theta_k)</script><p>å…¶ä¸­$\alpha_k$æ˜¯ç³»æ•°ï¼Œ$\alpha_k\geq0,\sum_{k=1}^{K}\alpha_k=1$ï¼Œ$\theta_k=(\mu_k,\sigma_k^2)$ï¼Œ$\phi(y\vert \theta_k)$ä¸ºé«˜æ–¯åˆ†å¸ƒå¯†åº¦ï¼š</p>
<script type="math/tex; mode=display">\phi(y\vert \theta_k) =\cfrac{1}{\sqrt{2\pi}\sigma_k}\exp\left(-\cfrac{(y-\mu_k)^2}{2\sigma_k^2}\right)</script><p>å‡è®¾è§‚æµ‹æ•°æ®$y_1,y_2,â€¦,y_N$ç”±ä¸Šè¿°é«˜æ–¯æ··åˆæ¨¡å‹ç”Ÿæˆï¼Œç°ç”¨EMç®—æ³•æ¥ä¼°è®¡å…¶å‚æ•°$\theta=(\alpha_1,\alpha_2,â€¦,\alpha_K;\theta_1,\theta_2,â€¦,\theta_K)$ã€‚</p>
<h5 id="1-æ˜ç¡®éšå˜é‡ï¼Œå†™å‡ºå®Œå…¨æ•°æ®çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°"><a href="#1-æ˜ç¡®éšå˜é‡ï¼Œå†™å‡ºå®Œå…¨æ•°æ®çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°" class="headerlink" title="1.æ˜ç¡®éšå˜é‡ï¼Œå†™å‡ºå®Œå…¨æ•°æ®çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°"></a>1.æ˜ç¡®éšå˜é‡ï¼Œå†™å‡ºå®Œå…¨æ•°æ®çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°</h5><p>å‡è®¾è§‚æµ‹æ•°æ®$y_j$æ˜¯è¿™æ ·äº§ç”Ÿçš„ï¼šé¦–å…ˆä¾æ¦‚ç‡$\alpha_k$é€‰æ‹©ç¬¬$k$ä¸ªé«˜æ–¯åˆ†å¸ƒåˆ†æ¨¡å‹$\phi(y\vert \theta_k)$ï¼Œæ¥ç€ç”±è¯¥åˆ†æ¨¡å‹ç”Ÿæˆè§‚æµ‹æ•°æ®$y_j$ï¼Œæ­¤æ—¶è§‚æµ‹æ•°æ®$y_j$ï¼ˆå…¶ä¸­$j=1,2,â€¦,N$ï¼‰æ˜¯å·²çŸ¥çš„ï¼Œåæ˜ è§‚æµ‹æ•°æ®$y_j$æ¥è‡ªç¬¬$k$ä¸ªåˆ†æ¨¡å‹çš„æ•°æ®æ˜¯æœªçŸ¥çš„ï¼Œæˆ‘ä»¬ç”¨éšå˜é‡$z_{jk}$æ¥è¡¨ç¤ºï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
z_{jk} = \left\{ \begin{array}{rcl}
1 & ç¬¬jä¸ªè§‚æµ‹æ•°æ®y_jæ¥è‡ªç¬¬kä¸ªåˆ†æ¨¡å‹ \\ 
 0 & å¦åˆ™ \\
\end{array}\right.</script><p>æ‰€ä»¥$z_{jk}$æ˜¯ä¸€ä¸ª0-1éšæœºå˜é‡ã€‚ç¡®å®šäº†æœªè§‚æµ‹æ•°æ®çš„è¡¨ç¤ºå½¢å¼åä¾¿å¯ä»¥å†™å‡ºå®Œå…¨æ•°æ®çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š</p>
<script type="math/tex; mode=display">\begin{aligned}
\ln P(Y,Z\vert \theta)&=\ln\left( P(Y\vert Z,\theta)P(Z\vert \theta)\right) \\
&=\ln\left( \prod_{j=1}^{N}\left( \prod_{k=1}^{K} [\phi(y_j\vert\theta_k)]^{z_{jk}}\times \prod_{k=1}^{K} \alpha_{k}^{z_{jk}}\right)\right) \\
&=\ln\left( \prod_{j=1}^{N}\left( \prod_{k=1}^{K} [\phi(y_j\vert\theta_k)]^{z_{jk}} \alpha_{k}^{z_{jk}}\right)\right) \\
&=\ln\left( \prod_{j=1}^{N}\prod_{k=1}^{K}[\alpha_{k}\phi(y_j\vert\theta_k)]^{z_{jk}}\right) \\
&= \sum_{j=1}^{N}\sum_{k=1}^{K}\ln\left([\alpha_{k}\phi(y_j\vert\theta_k)]^{z_{jk}}\right) \\
&= \sum_{j=1}^{N}\sum_{k=1}^{K}{z_{jk}}\ln(\alpha_{k}\phi(y_j\vert\theta_k)) \\
&= \sum_{j=1}^{N}\sum_{k=1}^{K}{z_{jk}}(\ln\alpha_{k}+\ln\phi(y_j\vert\theta_k)) \\
\end{aligned}</script><h5 id="2-EMç®—æ³•Eæ­¥ï¼šç¡®å®š-Q-å‡½æ•°"><a href="#2-EMç®—æ³•Eæ­¥ï¼šç¡®å®š-Q-å‡½æ•°" class="headerlink" title="2.EMç®—æ³•Eæ­¥ï¼šç¡®å®š$Q$å‡½æ•°"></a>2.EMç®—æ³•Eæ­¥ï¼šç¡®å®š$Q$å‡½æ•°</h5><script type="math/tex; mode=display">\begin{aligned}
Q(\theta,\theta^{(i)})&=\sum_Z P(Z\vert Y,\theta^{(i)})\ln P(Y,Z\vert \theta) \\
&=\sum_Z P(Z\vert Y,\theta^{(i)})\left\{\sum_{j=1}^{N}\sum_{k=1}^{K}{z_{jk}}(\ln\alpha_{k}+\ln\phi(y_j\vert\theta_k))\right\}\\
&=\sum_{j=1}^{N}\sum_{k=1}^{K}\left\{\sum_{z_{jk}}P(z_{jk}\vert y_j,\theta^{(i)}){z_{jk}}(\ln\alpha_{k}+\ln\phi(y_j\vert\theta_k))\right\} \quad(æ­¤å¤„\sum_{z_{jk}}è¡¨ç¤ºéå†z_{jk}çš„ä¸¤ç§å–å€¼æƒ…å†µï¼š0å’Œ1)\\
&=\sum_{j=1}^{N}\sum_{k=1}^{K}\left\{P(z_{jk}=1\vert y_j,\theta^{(i)})\cdot 1 \cdot (\ln\alpha_{k}+\ln\phi(y_j\vert\theta_k))+P(z_{jk}=0\vert y_j,\theta^{(i)})\cdot 0 \cdot (\ln\alpha_{k}+\ln\phi(y_j\vert\theta_k))\right\} \\
&=\sum_{j=1}^{N}\sum_{k=1}^{K}\left\{P(z_{jk}=1\vert y_j,\theta^{(i)})(\ln\alpha_{k}+\ln\phi(y_j\vert\theta_k))\right\}\\    
\end{aligned}</script><p>å…¶ä¸­$P(z_{jk}=1\vert y_j,\theta^{(i)})$è¡¨ç¤ºåœ¨ç»™å®š$\theta=\theta^{(i)}$çš„æ¡ä»¶ä¸‹ï¼ŒæŸä¸ªè§‚æµ‹æ•°æ®$y_j$æ˜¯ç”±ç¬¬$k$ä¸ªåˆ†æ¨¡å‹ç”Ÿæˆçš„æ¦‚ç‡ï¼Œç§°ä¸ºåˆ†æ¨¡å‹$k$å¯¹è§‚æµ‹æ•°æ®$y_j$çš„å“åº”åº¦ã€‚ç”±<strong>è´å¶æ–¯å®šç†</strong>å¯è¿›ä¸€æ­¥æ¨å¾—&lt;/sup&gt;<sup><a href="#ref4">[4]</a></sup>ï¼š</p>
<script type="math/tex; mode=display">\begin{aligned}
P(z_{jk}=1\vert y_j,\theta^{(i)})&=\cfrac{P(y_j\vert z_{jk}=1,\theta^{(i)})\cdot P(z_{jk}=1,\theta^{(i)})}{P(y_j,\theta^{(i)})} \\
&=\cfrac{P(y_j\vert z_{jk}=1,\theta^{(i)})\cdot P(z_{jk}=1,\theta^{(i)})}{\sum_{l=1}^{K}\alpha_l\phi(y_j\vert \theta_l^{(i)})} \\
&=\cfrac{\phi(y_j\vert \theta_k^{(i)})\cdot \alpha_k}{\sum_{l=1}^{K}\alpha_l\phi(y_j\vert \theta_l^{(i)})} \\
&=\cfrac{\alpha_k\cdot \phi(y_j\vert \theta_k^{(i)})}{\sum_{l=1}^{K}\alpha_l\phi(y_j\vert \theta_l^{(i)})}
\end{aligned}</script><p>$P(z_{jk}=1\vert y_j,\theta^{(i)})$ä¹Ÿå¯ä»¥çœ‹åšæ˜¯<strong>æŸä¸ª</strong>$z_{jk}$çš„æœŸæœ›<strong>ï¼ˆæ³¨æ„ä¸æ˜¯æ‰€æœ‰çš„ï¼Œå› ä¸º$z_{jk}$ä¸€å…±æœ‰$N\times K$ä¸ªï¼Œæ¯ä¸ª$z_{jk}$å‡ä¸ºä¸€ä¸ªç‹¬ç«‹çš„éšæœºå˜é‡ï¼Œæ­¤å¤„è¯´çš„åªæ˜¯å…¶ä¸­æŸä¸€ä¸ªï¼Œä¾‹å¦‚$z_{12}$çš„æœŸæœ›å€¼ï¼‰</strong>ï¼Œè¯æ˜å¦‚ä¸‹ï¼šç”±äºæ¯ä¸ª$z_{jk}$å‡ä¸º$0-1$éšæœºå˜é‡ï¼Œæ‰€ä»¥å¯¹äºæŸä¸ª$z_{jk}$æ¥è¯´ï¼Œå…¶æœŸæœ›ä¸ºï¼š</p>
<script type="math/tex; mode=display">\begin{aligned}
E[z_{jk}]&=\sum_{z_{jk}}\left(P(z_{jk}\vert y_j,\theta^{(i)})\cdot z_{jk}\right) \\
&=P(z_{jk}=1\vert y_j,\theta^{(i)})\cdot 1 + P(z_{jk}=0\vert y_j,\theta^{(i)})\cdot 0\\
&=P(z_{jk}=1\vert y_j,\theta^{(i)})\\
\end{aligned}</script><p>è¯æ¯•ã€‚ç°å°†$P(z_{jk}=1\vert y_j,\theta^{(i)})$ç®€è®°ä¸º$\gamma_{jk}$ï¼Œåˆ™ï¼š</p>
<script type="math/tex; mode=display">\begin{aligned}
Q(\theta,\theta^{(i)})&=\sum_{j=1}^{N}\sum_{k=1}^{K}\left\{\gamma_{jk}(\ln\alpha_{k}+\ln\phi(y_j\vert\theta_k))\right\} \\
&=\sum_{j=1}^{N}\sum_{k=1}^{K}\left\{\gamma_{jk}\ln\alpha_{k}+\gamma_{jk}\ln\phi(y_j\vert\theta_k)\right\} \\
&=\sum_{j=1}^{N}\sum_{k=1}^{K}\left\{\gamma_{jk}\ln\alpha_{k}+\gamma_{jk}\ln\left(\cfrac{1}{\sqrt{2\pi}\sigma_k}\exp\left(-\cfrac{(y_j-\mu_k)^2}{2\sigma_k^2}\right)\right)\right\} \\
&=\sum_{j=1}^{N}\sum_{k=1}^{K}\left\{\gamma_{jk}\ln\alpha_{k}+\gamma_{jk}\left(\ln\cfrac{1}{\sqrt{2\pi}}-\ln \sigma_k-\cfrac{(y_j-\mu_k)^2}{2\sigma_k^2}\right)\right\} \\
&=\sum_{j=1}^{N}\sum_{k=1}^{K}\left\{\gamma_{jk}\ln\alpha_{k}+\gamma_{jk}\ln\cfrac{1}{\sqrt{2\pi}}-\gamma_{jk}\ln \sigma_k-\gamma_{jk}\cfrac{(y_j-\mu_k)^2}{2\sigma_k^2}\right\}
\end{aligned}</script><h5 id="3-EMç®—æ³•Mæ­¥ï¼šæ±‚ä½¿å¾—-Q-å‡½æ•°è¾¾åˆ°æå¤§çš„-theta-i-1-alpha-1-i-1-alpha-2-i-1-â€¦-alpha-K-i-1-theta-1-i-1-theta-2-i-1-â€¦-theta-K-i-1"><a href="#3-EMç®—æ³•Mæ­¥ï¼šæ±‚ä½¿å¾—-Q-å‡½æ•°è¾¾åˆ°æå¤§çš„-theta-i-1-alpha-1-i-1-alpha-2-i-1-â€¦-alpha-K-i-1-theta-1-i-1-theta-2-i-1-â€¦-theta-K-i-1" class="headerlink" title="3.EMç®—æ³•Mæ­¥ï¼šæ±‚ä½¿å¾—$Q$å‡½æ•°è¾¾åˆ°æå¤§çš„$\theta^{(i+1)}=(\alpha_1^{(i+1)},\alpha_2^{(i+1)},â€¦,\alpha_K^{(i+1)};\theta_1^{(i+1)},\theta_2^{(i+1)},â€¦,\theta_K^{(i+1)})$"></a>3.EMç®—æ³•Mæ­¥ï¼šæ±‚ä½¿å¾—$Q$å‡½æ•°è¾¾åˆ°æå¤§çš„$\theta^{(i+1)}=(\alpha_1^{(i+1)},\alpha_2^{(i+1)},â€¦,\alpha_K^{(i+1)};\theta_1^{(i+1)},\theta_2^{(i+1)},â€¦,\theta_K^{(i+1)})$</h5><p>$Q(\theta,\theta^{(i)})$å…³äº$\mu_k$æ±‚åå¯¼ï¼ˆæ­¤æ—¶$k$æ˜¯å›ºå®šçš„ï¼‰ï¼š</p>
<script type="math/tex; mode=display">\begin{aligned}
\cfrac{\partial{Q(\theta,\theta^{(i)})}}{\partial{\mu_k}}&=\sum_{j=1}^{N}\left\{0+0-0-\cfrac{\gamma_{jk}}{2\sigma_k^2}\cdot 2 \cdot(y_j-\mu_k)\right\} \\
&=\sum_{j=1}^{N}\left\{-\cfrac{\gamma_{jk}}{\sigma_k^2}\cdot(y_j-\mu_k)\right\} \\
&=\cfrac{\mu_k}{\sigma_k^2}\sum_{j=1}^{N}\gamma_{jk}-\cfrac{1}{\sigma_k^2}\sum_{j=1}^{N}\gamma_{jk}y_j \\
\end{aligned}</script><p>ä»¤ä¸Šå¼ç­‰äº0å³å¯å¾—ï¼š</p>
<script type="math/tex; mode=display">\mu_k^{(i+1)}=\cfrac{\sum_{j=1}^{N}\gamma_{jk}y_j}{\sum_{j=1}^{N}\gamma_{jk}}</script><p>$Q(\theta,\theta^{(i)})$å…³äº$\sigma_k$æ±‚åå¯¼ï¼ˆæ­¤æ—¶$k$æ˜¯å›ºå®šçš„ï¼‰ï¼š</p>
<script type="math/tex; mode=display">\begin{aligned}
\cfrac{\partial{Q(\theta,\theta^{(i)})}}{\partial{\sigma_k}}&=\sum_{j=1}^{N}\left\{0+0-\gamma_{jk}\sigma_k^{-1}-\gamma_{jk}(y_j-\mu_k)^2\cdot\cfrac{1}{2}\cdot-2\cdot\sigma_k^{-3} \right\} \\
&=\sum_{j=1}^{N}\left\{\gamma_{jk}(y_j-\mu_k)^2\sigma_k^{-3}-\gamma_{jk}\sigma_k^{-1} \right\} \\
&=\sigma_k^{-3}\sum_{j=1}^{N}\gamma_{jk}(y_j-\mu_k)^2-\sigma_k^{-1}\sum_{j=1}^{N}\gamma_{jk} \\
\end{aligned}</script><p>ä»¤ä¸Šå¼ç­‰äº0å³å¯å¾—ï¼š</p>
<script type="math/tex; mode=display">[\sigma_k^{(i+1)}]^{2}=\cfrac{\sum_{j=1}^{N}\gamma_{jk}(y_j-\mu_k)^2}{\sum_{j=1}^{N}\gamma_{jk}}</script><p>æ±‚$\alpha_k^{(i+1)}$æ—¶éœ€è¦æ³¨æ„ï¼Œæ­¤æ—¶å­˜åœ¨çº¦æŸ$\sum_{k=1}^{K}\alpha_k^{(i+1)}=1$ï¼Œå› æ­¤è€ƒè™‘ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼Œé¦–å…ˆæ„é€ æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š</p>
<script type="math/tex; mode=display">L(\theta,\beta)=Q(\theta,\theta^{(i)})+\beta(\sum_{k=1}^{K}\alpha_k-1)</script><p>å¯¹$L(\theta,\beta)$å…³äº$\sigma_k$æ±‚åå¯¼ï¼ˆæ­¤æ—¶$k$æ˜¯å›ºå®šçš„ï¼‰ï¼š</p>
<script type="math/tex; mode=display">\begin{aligned}
\cfrac{\partial{L(\theta,\beta)}}{\partial{\alpha_k}}&=\cfrac{\sum_{j=1}^{N}\gamma_{jk}}{\alpha_{k}}+\beta \\
\end{aligned}</script><p>ä»¤ä¸Šå¼ç­‰äº0å³å¯å¾—ï¼š</p>
<script type="math/tex; mode=display">\alpha_{k}^{(i+1)}=\cfrac{\sum_{j=1}^{N}\gamma_{jk}}{-\beta}</script><p>åˆç”±çº¦æŸæ¡ä»¶å¯å¾—ï¼š</p>
<script type="math/tex; mode=display">\sum_{k=1}^{K}\alpha_k^{(i+1)}=\cfrac{\sum_{k=1}^{K}\sum_{j=1}^{N}\gamma_{jk}}{-\beta}=1</script><p>å…¶ä¸­$\sum_{k=1}^{K}\sum_{j=1}^{N}\gamma_{jk}=\sum_{j=1}^{N}\sum_{k=1}^{K}\gamma_{jk}=\sum_{j=1}^{N}1=N$ï¼Œæ‰€ä»¥</p>
<script type="math/tex; mode=display">\cfrac{N}{-\beta}=1\Rightarrow -\beta=N\Rightarrow \alpha_{k}^{(i+1)}=\cfrac{\sum_{j=1}^{N}\gamma_{jk}}{N}</script><p>ã€æ³¨ã€‘ï¼š</p>
<ul>
<li>ä¸Šè¿°â€œMæ­¥â€ä¸­æ±‚æå¤§åŒ–æ—¶ç›´æ¥å°±æ±‚åå¯¼ä»¤å…¶ç­‰äº0è¿›è¡Œæ±‚è§£ï¼Œæ±‚å‡ºæ¥çš„è§£ä¸€å®šæ˜¯æå¤§å€¼ç‚¹å—ï¼Ÿä¸ä¼šæ˜¯æå°å€¼ç‚¹å—ï¼Ÿä¸åº”è¯¥å…ˆåšå‡¹å‡¸æ€§åˆ¤æ–­å—ï¼Ÿä½†æ˜¯åšå‡¹å‡¸æ€§åˆ¤æ–­æ—¶$\sigma_k$çš„äºŒé˜¶åå¯¼æ­£è´Ÿæ€§æ— æ³•åˆ¤æ–­å‘€ã€‚ã€‚ã€‚éš¾é“å¦æœ‰éšæƒ…ï¼Ÿä¸ºä½•å‚è€ƒæ–‡çŒ®é‡Œéƒ½æ²¡æï¼ŸæŒ–å‘å¾…å¡«ã€‚ã€‚ã€‚</li>
<li><a href="#ref2">[2]</a>ä¸­ä¸‰ç¡¬å¸æ¨¡å‹ä½¿ç”¨EMç®—æ³•çš„æ¨å¯¼è¿‡ç¨‹å‚è§<a href="#ref2">[6]</a></li>
</ul>
<h3 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h3><p><span id="ref1">[1] <a href="https://en.wikipedia.org/wiki/Jensen%27s_inequality" target="_blank" rel="noopener">Jensenâ€™s inequality</a></span><br><span id="ref2">[2] æèˆª.ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹</span><br><span id="ref3">[3] cs229-notes8</span><br><span id="ref4">[4] å‘¨å¿—å.ã€Šæœºå™¨å­¦ä¹ ã€‹</span><br><span id="ref5">[5] <a href="http://alexkong.net/2014/07/GMM-and-EM/" target="_blank" rel="noopener">é«˜æ–¯æ··åˆæ¨¡å‹å’ŒæœŸæœ›æœ€å¤§åŒ–ç®—æ³•</a></span><br><span id="ref6">[6] <a href="http://www.cnblogs.com/Determined22/p/5776791.html" target="_blank" rel="noopener">NLP â€”â€” å›¾æ¨¡å‹ï¼ˆé›¶ï¼‰ï¼šEMç®—æ³•ç®€è¿°åŠç®€å•ç¤ºä¾‹ï¼ˆä¸‰ç¡¬å¸æ¨¡å‹ï¼‰</a></span></p>

 
                <!-- Meta -->
                <div class="post-meta">
                    <hr>
                    <br>
                    <div class="post-tags">
                        
                            

<a href="/tags/EMç®—æ³•/">#EMç®—æ³•</a>


                        
                    </div>
                    <div class="post-date">
                        2019 å¹´ 03 æœˆ 13 æ—¥
                    </div>
                </div>
            </div>

            <!-- Comments -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- Disqus Comments -->


            </div>
        </div>
    </div>
</article>
</section>

    <!-- Scripts -->
    <!-- jQuery -->
<script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="//cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<script type="text/javascript">
	console.log('Hexo-theme-hollow designed by zchen9 ğŸ™‹ Â© 2015-' + (new Date()).getFullYear());
</script>

    <!-- Google Analytics --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    

</body>

</html>